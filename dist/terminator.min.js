/**
@author	leeluolee
@version	0.0.1
@homepage	http://leeluolee.github.io/terminator
*/
!function(){"use strict";function t(e,r,n){function i(){n=n||e,r=r||"root";var t=new Error('Failed to require "'+n+'" from "'+r+'"');throw t.path=n,t.parent=r,t.require=!0,t}var s=t.resolve(e);if(null==s)return void i();var a=t.modules[s];if(!a._resolving&&!a.exports){var u={};u.exports={},u.client=u.component=!0,a._resolving=!0,a.call(this,u.exports,t.relative(s),u),delete a._resolving,a.exports=u.exports}return a.exports}t.modules={},t.aliases={},t.exts=["",".js",".json","/index.js","/index.json"],t.resolve=function(e){"/"===e.charAt(0)&&(e=e.slice(1));for(var r=0;5>r;r++){var n=e+t.exts[r];if(t.modules.hasOwnProperty(n))return n;if(t.aliases.hasOwnProperty(n))return t.aliases[n]}},t.normalize=function(t,e){var r=[];if("."!=e.charAt(0))return e;t=t.split("/"),e=e.split("/");for(var n=0;n<e.length;++n)".."===e[n]?t.pop():"."!=e[n]&&""!=e[n]&&r.push(e[n]);return t.concat(r).join("/")},t.register=function(e,r){t.modules[e]=r},t.alias=function(e,r){function n(){throw new Error('Failed to alias "'+e+'", it does not exist')}return t.modules.hasOwnProperty(e)?void(t.aliases[r]=e):void n()},t.relative=function(e){function r(n){var i=r.resolve(n);return t(i,e,n)}var n=t.normalize(e,"..");return r.resolve=function(r){var i=r.charAt(0);if("/"===i)return r.slice(1);if("."===i)return t.normalize(n,r);for(var s=e.split("/"),a=s.length;a--&&"deps"!==s[a];);return r=s.slice(0,a+2).join("/")+"/deps/"+r},r.exists=function(e){return t.modules.hasOwnProperty(r.resolve(e))},r},t.register("terminator/src/browser.js",function(t,e){e("./common")}),t.register("terminator/src/common.js",function(t,e){e("./parser/lexer.js"),e("./parser/parser.js")}),t.register("terminator/src/util.js",function(t,e,r){var n=r.exports,i=[].slice;n.uid=function(){var t=0;return function(){return t++}}(),n.slice=function(t,e,r){return i.call(t,e,r)},n.typeOf=function(t){return null==t?String(t):{}.toString.call(t).slice(8,-1).toLowerCase()},n.extend=function(t,e,r){for(var n in e)("undefined"==typeof t[n]||r)&&(t[n]=e[n]);return t};var s=/\r\n|[\n\r\u2028\u2029]/g;n.trackErrorPos=function(t,e){s.lastIndex=0;for(var r,n,i=1,a=0,u=t.length;n=s.exec(t);)n.index<e?(++i,a=n.index+1):r=n.index;r||(r=u-1);var o=e-10;a>o&&(o=a);var h=e+10;h>r&&(h=r);var c=t.slice(o,h),l=i+"> "+(o>=a?"...":""),f=r>h?"...":"";return l+c+f+"\n"+new Array(l.length+e-o+1).join(" ")+"^"};var a=/\(\?\!|\(\?\:|\?\=/;n.findSubCapture=function(t){for(var e=0,r=0,n=t.length,i=t.split(a).length-1;n--;){var s=t.charAt(n);(0===n||"\\"!==t.charAt(n-1)||"?"!==t.charAt(n+1))&&("("===s&&e++,")"===s&&r++)}if(e!==r)throw"RegExp: "+t+"'s bracket is not marched";return e-i},n.assert=function(t,e){if(!t)throw e;return!0}}),t.register("terminator/src/env.js",function(t){t.svg=function(){return"undefined"!=typeof document&&document.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1")}(),t.transition=function(){}}),t.register("terminator/src/dom.js",function(t,e,r){var n=r.exports,i=(e("./env.js"),e("./util"));n.create=function(t,e){return document[e?i.assert("svg"!==e||evn.svg,"this browser has no svg support")&&"createElementNS":"createElement"](t,e)},n.attr=function(){},n.css=function(){},n.addClass=function(){},n.delClass=function(){},n.hasClass=function(){}}),t.register("terminator/src/parser/lexer.js",function(t,e,r){function n(t){return function(e){return{type:t,value:e}}}function i(t,e){return function(){return{type:t,value:arguments[e]}}}function s(t,e){this.input=(t||"").trim(),this.opts=e||{},this.map=2!=this.opts.mode?p:v}function a(t){for(var e,r,n={},i=0,s=t.length;s>i;i++)e=t[i],r=e[2]||"INIT",(n[r]||(n[r]={rules:[],links:[]})).rules.push(e);return u(n)}function u(t){var e,r,s,a,u,c;for(var f in t){e=t[f],e.curIndex=1,r=e.rules,s=[];for(var f=0,p=r.length;p>f;f++){if(rule=r[f],u=rule[0],a=rule[1],"string"==typeof a)if(~a.indexOf(":")){var v=a.split(":"),E=v[0],T=parseInt(v[1].replace("$",""));a=i(E,T)}else a=n(a);"regexp"==h.typeOf(u)&&(u=u.toString().slice(1,-1)),u=u.replace(/\{(\w+)\}/g,function(t,e){return"string"==typeof l[e]?o(l[e]):String(l[e]).slice(1,-1)}),c=h.findSubCapture(u)+1,e.links.push([e.curIndex,c,a]),e.curIndex+=c,s.push(u)}e.TRUNK=new RegExp("^(?:("+s.join(")|(")+"))")}return t}function o(t){return t.replace(/[-[\]{}()*+?.\\^$|,#\s]/g,function(t){return"\\"+t})}var h=e("../util.js"),c=s.prototype;c.skipspace=function(t){var e,r=0,n=t;for(e=n.charCodeAt(r);e&&(32===e||13===e||10===e||8232===e||8233===e);)r++,e=n.charCodeAt(r);return this.index+=r,t.slice(r)},c.lex=function(t){t=(t||this.input).trim();{var e,r,n,i,s,a=[];this.input=t}for(this.index=0,this.states=["INIT"];t;)s=this.state(),e=this.map[s],r=e.TRUNK.exec(t),r||(console.log(a),this.error("Unrecoginized Token")),n=r[0].length,i=this._process.call(this,r,e),i&&a.push(i),this.index+=n,t=t.slice(n);return a.push({type:"EOF"}),a},c.next=function(){var t=this.map[this.state()],e=t.TRUNK.exec(str);e||this.error("Unrecoginized Token");var r=e[0].length,n=this._process.apply(this,e);return this.input=this.input.slice(r),n},c.error=function(t){throw"Parse Error: "+t+":\n"+h.trackErrorPos(this.input,this.index)},c._process=function(t,e){for(var r=e.links,n=r.length,i=0;n>i;i++){var s=r[i],a=s[2],u=s[0];if(void 0!=t[u]){if(a){var o=a.apply(this,t.slice(u,u+s[1]));o&&(o.pos=this.index)}break}}return o},c.addRule=function(){},c.enter=function(t){return this.states.push(t),this},c.state=function(){var t=this.states;return t[t.length-1]},c.leave=function(){this.states.pop()};var l={BEGIN:"{",END:"}",NAME:/(?:[:_A-Za-z][-\.:_0-9A-Za-z]*)/,IDENT:/[\$_A-Za-z][-_0-9A-Za-z\$]*/},f={COMMENT:[/<!--([^\x00]*?)-->/],ENTER_JST:[/[^\x00\<]*?(?={BEGIN})/,function(t){return this.enter("JST"),t?{type:"TEXT",value:t}:void 0}],ENTER_JST2:[/[^\x00]*?(?={BEGIN})/,function(t){return this.enter("JST"),t?{type:"TEXT",value:t}:void 0}],ENTER_TAG:[/[^\x00<>]*?(?=<)/,function(t){return this.enter("TAG"),t?{type:"TEXT",value:t}:void 0}],TEXT:[/[^\x00]+/,"TEXT"],TAG_NAME:[/{NAME}/,"NAME","TAG"],TAG_OPEN:[/<({NAME})\s*/,function(t,e){return{type:"TAG_OPEN",value:e}},"TAG"],TAG_CLOSE:[/<\/({NAME})[\r\n\f ]*>/,function(t,e){return this.leave(),{type:"TAG_CLOSE",value:e}},"TAG"],TAG_ENTER_JST:[/(?={BEGIN})/,function(){this.enter("JST")},"TAG"],TAG_PUNCHOR:[/[>\/=]/,function(t){return">"===t&&this.leave(),{type:t,value:t}},"TAG"],TAG_SPACE:[/[ \r\n\f]+/,null,"TAG"],JST_COMMENT:[/{!([^\x00]*?)!}/,null,"JST"],JST_OPEN:["{BEGIN}s*({IDENT})",function(t,e){return{type:"OPEN",value:e}},"JST"],JST_LEAVE:[/{END}/,function(){return this.leave("JST"),{type:"END"}},"JST"],JST_EXPR_OPEN:["{BEGIN}([=-])",function(t){var e="="==t;return{type:"EXPR_OPEN",escape:e}},"JST"],JST_CLOSE:[/{BEGIN}\s*\/\s*({IDENT})\s*{END}/,function(t,e){return this.leave("JST"),{type:"CLOSE",value:e}},"JST"],JST_IDENT:["{IDENT}","IDENT","JST"],JST_SPACE:[/[ \r\n\f]+/,null,"JST"],JST_PUNCHOR:[/[=!]?==|[-=><+*\/%]?\=|\|\||&&|[\<\>\[\]\(\)\-\|\{}\+\*\/%?:\.!,#]/,function(t){return{type:t,value:t}},"JST"],JST_STRING:[/'([^']*)'|"([^"]*)"/,function(t,e,r){return{type:"STRING",value:e||r}},"JST"],JST_NUMBER:[/[0-9]*\.[0-9]+|[0-9]+/,function(t){var e;return"number"==typeof(e=parseInt(t))&&e===e?{type:"NUMBER",value:e}:void 0},"JST"]},p=a([f.COMMENT,f.ENTER_JST,f.ENTER_TAG,f.TEXT,f.TAG_NAME,f.TAG_OPEN,f.TAG_CLOSE,f.TAG_PUNCHOR,f.TAG_ENTER_JST,f.TAG_SPACE,f.JST_OPEN,f.JST_EXPR_OPEN,f.JST_IDENT,f.JST_SPACE,f.JST_LEAVE,f.JST_CLOSE,f.JST_NUMBER,f.JST_PUNCHOR,f.JST_STRING,f.JST_COMMENT]),v=a([f.ENTER_JST2,f.TEXT,f.JST_OPEN,f.JST_EXPR_OPEN,f.JST_IDENT,f.JST_SPACE,f.JST_LEAVE,f.JST_CLOSE,f.JST_NUMBER,f.JST_PUNCHOR,f.JST_STRING,f.JST_COMMENT]);r.exports=s}),t.register("terminator/src/parser/node.js",function(t,e,r){r.exports={element:function(t,e,r){return{type:"element",tag:t,attrs:e,children:r}},"if":function(t,e,r){return{type:"if",test:t,consequent:e,alternate:r}},list:function(t,e,r){return{type:"list",sequence:t,variable:e,body:r}},text:function(t){return t},inteplation:function(t){return{type:"inteplation",expr:t}},filter:function(t,e){return{type:"filter",object:t,filters:e}},condition:function(t,e,r){return{type:"condition",test:t,consequent:e,alternate:r}},logic:function(t,e,r){return{type:"logic",op:t,left:e,right:r}},binary:function(t,e,r){return{type:"binary",op:t,left:e,right:r}},unary:function(t,e){return{type:"logic",op:t,arg:e}},call:function(t,e){return{type:"call",callee:t,args:e}},member:function(t,e,r){return{type:"member",obj:t,prop:e,isComputed:r}}}}),t.register("terminator/src/parser/parser.js",function(t,e,r){function n(t,e){e=e||{},this.input=t,this.tokens=new a(t,e).lex(),this.pos=0,this.length=this.tokens.length}var i=e("../util.js"),s=e("./node.js"),a=e("./lexer.js"),u=n.prototype;u.parse=function(){return this.pos=0,this.program()},u.ll=function(t){t=t||1,0>t&&(t+=1);var e=this.pos+t-1;return e>this.length-1?this.tokens[this.length-1]:this.tokens[e]},u.la=function(t){return(this.ll(t)||"").type},u.match=function(t,e){if(r=this.eat(t,e))return r;var r=this.ll();this.error("expect ["+t+(null==e?"":":"+e)+']" -> got "['+r.type+(null==e?"":":"+r.value)+"]",r.pos)},u.error=function(t,e){throw"Parse Error: "+t+":\n"+i.trackErrorPos(this.input,null!=e?e:this.ll().pos)},u.next=function(t){t=t||1,this.pos+=t},u.eat=function(t,e){var r=this.ll();if("string"!=typeof t){for(var n=t.length;n--;)if(r.type==t[n])return this.next(),r}else if(r.type==t&&("undefined"==typeof e||r.value==e))return this.next(),r;return!1},u.isEmpty=function(t){return!t||t.length},u.program=function(){for(var t=[],e=this.ll();"EOF"!==e.type&&"TAG_CLOSE"!==e.type;)t.push(this.statement()),e=this.ll();return t},u.statements=function(t){for(var e,r=[];!(e=this.eat("CLOSE",t));)r.push(this.statement());return r},u.statement=function(){var t=this.ll();switch(t.type){case"NAME":case"TEXT":var e=t.value;for(this.next();t=this.eat(["NAME","TEXT"]);)e+=t.value;return e;case"TAG_OPEN":return this.xml();case"OPEN":return this.directive();case"EXPR_OPEN":return this.inteplation();default:this.error("Unexpected token: "+this.la())}},u.xml=function(){var t,e,r,n;return t=this.match("TAG_OPEN").value,e=this.attrs(),n=this.eat("/"),this.match(">"),n||(r=this.program(),this.eat("TAG_CLOSE",t)||this.error("expect </"+t+"> gotno matched closeTag")),s.element(t,e,r)},u.attrs=function(){var t=this.ll();if("NAME"===t.type){var e,r=[];do e={name:t.value},this.eat("=")&&(e.value=this.attvalue()),r.push(e);while(t=this.eat("NAME"))}},u.attvalue=function(){var t=this.ll();switch(t.type){case"NAME":case"STRING":return this.next(),t.value;case"EXPR_OPEN":return this.inteplation();default:this.error("Unexpected token: "+this.la())}return t.value},u.directive=function(t){return t=t||this.ll().value,"function"==typeof this[t]?this[t]():void this.error("Undefined directive["+t+"]")},u.inteplation=function(){this.match("EXPR_OPEN");var t=this.filter();return this.match("END"),t},u.filter=function(){var t=this.expr(),e=this.eat("|");if(e){var r,n=[];do r={},r.name=this.match("IDENT").value,r.args=this.arguments("|");while(e=this.eat("|"));return s.filter(t,n)}return t},u.if=function(){this.next();var t=this.expr(),e=[],r=[],n=e;this.match("END");for(var i,a;!(a=this.eat("CLOSE"));)if(i=this.ll(),"OPEN"==i.type)switch(i.value){case"else":n=r,this.next(),this.match("END");break;case"elseif":return r.push(this.if()),s.if(t,e,r);default:n.push(this.statement())}else n.push(this.statement());return"if"!==a.value&&this.error("Unmatched if directive"),s.if(t,e,r)},u.list=function(){this.next();var t,e,r=this.expr(),n=[],i=[],a=n;for(this.match("IDENT","as"),t=this.match("IDENT").value,this.match("END");!(e=this.eat("CLOSE"));)this.eat("OPEN","else")?(a=i,this.match("END")):a.push(this.statement());return"list"!==e.value&&this.error("expect {/list} got {/"+e.value+"}",e.pos),s.list(r,t,n,i)},u.expr=function(){return this.condition()},u.condition=function(){var t=this.or();if(this.eat("?")){var e=this.assign();this.match(":");var r=this.assign();return s.condition(t,e,r)}return t},u.or=function(){var t=this.and();return this.eat("||")?s.logic("||",t,this.or()):t},u.and=function(){var t=this.equal();return this.eat("&&")?s.logic("&&",t,this.and()):t},u.equal=function(){var t=this.relation();return(ll=this.eat(["==","!=","===","!=="]))?s.logic(ll.type,t,this.equal()):t},u.relation=function(){var t=this.additive();return(ll=this.eat(["<",">",">=","<="])||this.eat("IDENT","in"))?s.logic(ll.value,t,this.relation()):t},u.additive=function(){var t,e=this.multive();return(t=this.eat(["+","-"]))?s.binary(t.type,e,this.additive()):e},u.multive=function(){var t,e=this.unary();return(t=this.eat(["*","/","%"]))?s.binary(t.type,e,this.multive()):e},u.unary=function(){var t;return(t=this.eat(["+","-","~","!"]))?s.unary(t.type,this.unary()):this.member()},u.member=function(t){t=t||this.primary();var e;if(e=this.eat(["[",".","("]))switch(e.type){case".":return t=s.member(t,this.match("IDENT").value,!1),this.member(t);case"[":return t=s.member(t,this.expr(),!0),this.match("]"),this.member(t);case"(":return t=s.call(t,this.arguments()),this.match(")"),this.member(t)}return t},u.arguments=function(t){t=t||")";var e=[];do this.la()!==t&&e.push(this.condition());while(this.eat(","));return e},u.primary=function(){var t=this.ll();switch(t.type){case"{":return this.object();case"[":return this.array();case"(":return this.paren();case"IDENT":switch(this.next(),t.value){case"true":return!0;case"fasle":return!1;case"null":return null;case"undefined":return void 0;case"this":return s.this();default:return t}break;case"STRING":case"NUMBER":return this.next(),t.value;default:this.error("Unexpected Token: "+t.type)}},u.object=function(){this.match("{");for(var t,e=[];t=this.eat(["STRING","IDENT","NUMBER"]);){this.match(":");var r=this.condition();this.eat(","),e.push({key:t.value,value:r})}e.length;return this.match("}"),s.object(e)},u.array=function(){this.match("[");for(var t,e=[];t=this.assign();)this.eat(","),e.push(t);e.length;return this.match("]"),s.array(e)},u.paren=function(){this.match("(");var t=this.expr();return this.match(")"),t},r.exports=n}),t.alias("terminator/src/browser.js","terminator/index.js"),"object"==typeof exports?module.exports=t("terminator"):"function"==typeof define&&define.amd?define(function(){return t("terminator")}):window.terminator=t("terminator")}();